# ESP32-Arduino UART 통신 프로젝트

## 변경 이력

### 2025-04-12 v1.9.0
1. **자동모드 기능 개선**
   - 거리 기반 제어 기능 완성
     - 기존: 거리가 100mm 이내일 때만 LED와 가습기 켜기 구현
     - 추가: 거리가 100mm 초과할 때 LED와 가습기 자동 끄기 추가
   - 습도 기반 팬 제어 유지
     - 습도 80% 이상 시 팬 켜기
     - 습도 70% 미만 시 팬 끄기
2. **통신 안정성 개선**
   - UART 데이터 수신 방식 개선
     - 문자열 기반 읽기에서 바이트 단위 수신 및 버퍼링 방식으로 변경
   - 디버깅 설정 최적화
     - 디버깅 출력 기본값 비활성화로 변경 (성능 최적화)

### 2025-04-01 v1.8.0
1. **자동모드 기능 개선**
   - 거리 기반 제어 기능 완성
     - 기존: 거리가 100mm 이내일 때만 LED와 가습기 켜기 구현
     - 추가: 거리가 100mm 초과할 때 LED와 가습기 자동 끄기 추가
   - 습도 기반 팬 제어 유지
     - 습도 80% 이상 시 팬 켜기
     - 습도 70% 미만 시 팬 끄기
2. **통신 안정성 개선**
   - UART 데이터 수신 방식 개선
     - 문자열 기반 읽기에서 바이트 단위 수신 및 버퍼링 방식으로 변경
   - 디버깅 설정 최적화
     - 디버깅 출력 기본값 비활성화로 변경 (성능 최적화)

### 2025-04-11 v1.7.0
1. **UART 통신 최적화**
   - 불필요한 디버깅 코드 제거
     - Serial.print 문 대부분 제거
     - 기본 디버깅 모드 비활성화 (debugEnabled = false)
     - debugLog 함수 간소화
   - 명령어 전송 및 처리 함수 최적화
     - sendCommand 함수에서 디버깅 출력 제거
     - processArduinoData 함수의 로그 출력 제거
     - 센서 데이터 읽기 함수의 불필요한 출력 제거
   - 센서 데이터 전송 개선
     - delay 시간 단축 (50ms → 30ms)
     - 필수적인 명령과 상태 정보만 유지
   - 전반적인 통신 효율성 증가
     - 통신량 감소로 인한 부하 감소
     - 핵심 기능만 유지하여 코드 가독성 향상

### 2025-04-02 v1.9.1
1. **TFT 백라이트 제어 방식 복구**
   - 기존 백라이트 제어 방식 복원
     - PWM 제어 관련 컴파일 오류로 인해 디지털 출력 방식 유지
     - GPIO 5번 핀을 출력 모드로 설정하고 HIGH로 유지하여 백라이트 제어
   - TFT 디스플레이 초기화 코드 위치 복원
     - 화면 방향 설정을 `setRotation(1)`로 유지
     - 초기화 코드를 원래 위치로 복원

### 2025-03-31 v1.2.0
1. **UI 개선**
   - Control 영역 완전 제거

## 프로젝트 개요
ESP32와 Arduino R4 WiFi 간의 UART 통신을 통해 릴레이(팬, LED, 가습기)를 제어하고 센서 데이터를 모니터링하는 프로젝트입니다.

### 주요 기능
1. **릴레이 제어**
   - 팬, LED, 가습기 등의 기기 원격 제어
   - UART 통신을 통한 명령어 전송
   - 자동/수동 모드 전환 기능

2. **센서 모니터링**
   - MAX30102: 심박수 모니터링
   - SHT31: 온도 및 습도 측정
   - VL53L0X: 거리 측정

### 통신 방식
- ESP32와 Arduino R4 WiFi 간 UART 직렬 통신 사용
- 간단한 명령어 기반 프로토콜 구현

## 하드웨어 연결
### UART 연결
- ESP32 TX → Arduino RX
- ESP32 RX → Arduino TX
- 공통 GND (필수)

### I2C 센서 연결 (ESP32 측)
- SDA: GPIO21
- SCL: GPIO22

### 버튼 연결 (아두이노 측)
- 팬 제어 버튼: Arduino D5 핀
- LED 제어 버튼: Arduino D6 핀
- 가습기 제어 버튼: Arduino D7 핀
- 자동/수동 모드 전환 버튼: Arduino D8 핀

## 주의사항
1. ESP32-WROOM-32의 기능적 한계를 고려한 최적화 적용
2. 센서 초기화 실패 시 재시도 로직 구현
3. UART 통신 시 명확한 명령어 및 응답 형식 준수
